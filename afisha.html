<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Афіша</title>

  <!-- прибираємо 404 favicon -->
  <link rel="icon" href="data:,">

  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <div id="site-header"></div>
  <script type="module" src="./scripts/include.js"></script>

  <main class="main">
    <section class="section">
      <h1>Афіша</h1>

      <!-- твої фільтри, якщо треба -->
      <div class="filters" style="margin: 12px 0">
        <button class="btn">Всі міста</button>
        <button class="btn secondary">Дніпро</button>
        <button class="btn secondary">Кривий Ріг</button>
      </div>

      <div id="afisha-root" class="grid"></div>
      <p id="afisha-empty" style="display:none">Подій за вибраним фільтром поки немає.</p>
    </section>
  </main>

  <div id="site-footer"></div>

  <script>
    // ГОЛОВНЕ: всі шляхи відносні (./…)
    const DATA_URL = './data/afisha.json';  // файл лежить у site-081125/data/afisha.json
    const root = document.getElementById('afisha-root');
    const empty = document.getElementById('afisha-empty');

    // Дуже толерантний рендер: підхоплює будь-які назви полів
    function field(o, keys, d='') {
      for (const k of keys) if (o && o[k] != null) return o[k];
      return d;
    }

    function card(item) {
      const title = field(item, ['title','name','show','event','label','slug'], '');
      const poster = field(item, ['poster','image','img','picture'], '');
      const city = field(item, ['city','місто'], '');
      const venue = field(item, ['venue','theatre','театр'], '');
      const href = './show.html' + (item.slug ? ('?slug=' + encodeURIComponent(item.slug)) : '');

      return `
        <a class="card" href="${href}">
          ${poster ? `<img class="card-poster" loading="lazy" src="${poster}" alt="${title}">` : ''}
          <div class="card-body">
            <h3 class="card-title">${title}</h3>
            <p class="card-meta">${[city, venue].filter(Boolean).join(' • ')}</p>
          </div>
        </a>
      `;
    }

    fetch(DATA_URL)
      .then(r => { if (!r.ok) throw new Error('Not found: ' + DATA_URL); return r.json(); })
      .then(items => {
        if (!Array.isArray(items) || items.length === 0) {
          empty.style.display = 'block';
          return;
        }
        root.innerHTML = items.map(card).join('');
      })
      .catch(err => {
        console.error(err);
        empty.textContent = 'Не вдалося завантажити афішу.';
        empty.style.display = 'block';
      });
  </script>
</body>
</html>
